<%= simple_form_for(@user) do |f| %>
  <%= f.error_notification %>

  <div class="form-inputs">
    <%= f.input :name, autofocus: true %>
    <%= f.input :email %>    
    <%= f.input :phone_number %>
    
    <% if can? :manage_institution, User %>
      <%= f.association :institution, collection: Institution.all %>
    <% else %>
      <%= f.association :institution, collection: Institution.where(id: current_user.institution.id), include_blank: false, disabled: true %>
    <% end %>

    <% if can? :manage_role, User %>
      <% if can? :assign_superuser, User %>
        <%= f.input :role, collection: User::ROLES.sort.map { |r| [r.titleize, r] } %>
      <% else %>
        <%= f.input :role, collection: (User::ROLES - ['superuser']).sort.map { |r| [r.titleize, r] } %>
      <% end %>
    <% end %>
  </div>

  <div class="form-actions">
    <%= f.button :submit, "Submit", {class: "btn btn-success"} %>
    <%= show_link @user, "Cancel" %>
  </div>
<% end %>